{% extends "base.html" %}
{% load static %}
{% block content %}
<h2>{{ event }}</h2>
<img class="card-img-top" src="{{ event.featured_image }}">
{{ event.content }}
{% for timeslot in timeslots %}
{% if timeslot.number_of_attendees >= event.max_attendees %}
<h2>Sorry, this timeslot is fully booked</h2>
{% elif user.is_authenticated %}
<form action="{% url 'timeslot_booking' event.slug timeslot.id %}" method="POST" >
    {% csrf_token %}
    {% if user.id in timeslot.attendees %}
<button type="submit" class="btn btn-danger">{{ timeslot }} - Cancel your booking</button>
{% else %}
<button type="submit" class="btn btn-success">{{ timeslot }} - Book</button>
{% endif %}
</form>
{% else %}
<p>Please log in or create an account in order to book events</p>
{% endif %}
{% endfor %}
{% endblock content %}

<!-- can format dates/times in templates manually if model method does not work-->